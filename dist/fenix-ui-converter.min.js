define(["jquery","underscore","loglevel","handlebars"],function(e,t,r,o){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){var o,n;o=[r(2),r(3),r(4),r(5)],n=function(e,t,r,o){"use strict";function n(){return this}return n.prototype.toD3P=function(o,n){var i={},u=this;return t.each(n.values,function(t,n){var a=u.cleanArray(t),c=o[n]||{},s=c.format||{},l=s.items||n;a.length>0?i[l]=e.extend(!0,{},u.compileFilter(n,a,o)):r.warn(n+" column excluded from FENIX conversion because it has no values")}),i},n.prototype.toFilter=function(o,n){var i={},u=this;return t.each(n.values,function(t,n){var a=u.cleanArray(t),c=o[n]||{},s=c.format||{},l=s.metadataAttribute;return l?void(a.length>0?i[l]=e.extend(!0,{},u.compileFilter(n,a,o)):r.warn(n+" column excluded from FENIX filter because it has no values")):void r.warn(n+" impossible to find format.metadataAttribute configuration")}),i},n.prototype.compileFilter=function(e,t,o){var n=o[e]||{},i=n.format||{},u=i.template,a=i.output||"codes";if(u)return this.compileTemplate(e,t,n,u);var c,s=i.dimension||e;switch(a.toLocaleLowerCase()){case"freetext":return this.createFreeTextFilter(e,t,n,s);case"codes":return c='{ "codes":[{"uid": "{{{uid}}}", "version": "{{version}}", "codes": [{{{codes}}}] } ]}',this.compileTemplate(e,t,n,s,c);case"time":return this.createTimeFilter(e,t,n,s);case"enumeration":return this.createEnumerationFilter(e,t,n,s);default:return r.warn(e+" not included in the result set. Missing format configuration."),{}}},n.prototype.compileTemplate=function(n,i,u,a,c){var s=e.extend(!0,u.cl,u.format,{codes:'"'+i.join('","')+'"'});if(c||r.error("Impossible to find '"+n+"' process template. Check your '"+n+"'.filter.process configuration."),!s.uid)return void r.error("Impossible to find '"+n+"' code list configuration for FENIX output format export.");var l=o.compile(c),f=JSON.parse(l(s)),p=f.codes;return t.each(p,function(e){e.version||delete e.version}),f},n.prototype.createTimeFilter=function(r,o,n,i){var u,a=[],c="object"==typeof o[0];if(c){var s=t.findWhere(o,{parent:"from"})||{},l=t.findWhere(o,{parent:"to"})||{},f={from:null,to:null};f.from=s.value,f.to=l.value,a.push(e.extend({},f))}else u=o.map(function(e){return parseInt(e,10)}).sort(function(e,t){return e-t}),t.each(u,function(e){a.push({from:e,to:e})});return{time:a}},n.prototype.createEnumerationFilter=function(e,t,r,o){return{enumeration:t}},n.prototype.createFreeTextFilter=function(e,t,r,o){return{text:t[0]}},n.prototype.cleanArray=function(e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t},new n}.apply(t,o),!(void 0!==n&&(e.exports=n))},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=o}])});
//# sourceMappingURL=fenix-ui-converter.min.js.map